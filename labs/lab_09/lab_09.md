# Криптоалгоритмы


## Цель работы

Получение практических навыков защиты программного обеспечения от несанкционированного доступа путем шифрования с использованием криптоалгоритмов.


## Продолжительность и сроки сдачи

Продолжительность работы: - 4 часа.

Мягкий дедлайн (10 баллов): 01.12.2025

Жесткий дедлайн (5 баллов): 08.12.2025


## Краткие теоретические сведения

### Основные понятия криптографии

*   **Криптография** — наука о методах обеспечения конфиденциальности, целостности, аутентичности и невозможности отказа от авторства данных.
*   **Исходный текст (plaintext)** — читаемые данные, которые необходимо защитить.
*   **Шифротекст (ciphertext)** — результат шифрования, нечитаемые данные.
*   **Шифрование (encryption)** — процесс преобразования исходного текста в шифротекст.
*   **Дешифрование (decryption)** — процесс преобразования шифротекста обратно в исходный текст.
*   **Ключ (key)** — секретная информация, используемая алгоритмом шифрования/дешифрования. Определяет результат шифрования.

### Симметричное шифрование

*   **Принцип:** Один и тот же ключ используется для шифрования и дешифрования.
*   **Достоинства:** Высокая скорость работы.
*   **Недостатки:** Проблема безопасной передачи ключа сторонам.
*   **Примеры алгоритмов:**
    *   **AES (Advanced Encryption Standard)** — современный стандарт, основан на substitution-permutation network. Размеры ключа: 128, 192, 256 бит.
    *   **DES (Data Encryption Standard)** — устаревший алгоритм, размер ключа 56 бит считается ненадежным.
    *   **3DES (Triple DES)** — трехкратное применение DES для увеличения стойкости, но медленнее AES.

### Асимметричное шифрование (криптография с открытым ключом)

*   **Принцип:** Используется пара ключей — открытый (public key) и закрытый (private key).
    *   **Открытый ключ** используется для шифрования. Может свободно распространяться.
    *   **Закрытый ключ** используется для дешифрования. Должен храниться в секрете.
*   **Достоинства:** Решает проблему распределения ключей.
*   **Недостатки:** Значительно медленнее симметричного шифрования.
*   **Примеры алгоритмов:**
    *   **RSA (Rivest–Shamir–Adleman)** — основан на вычислительной сложности задачи факторизации больших чисел.
    *   **ECC (Elliptic Curve Cryptography)** — основан на алгебраической структуре эллиптических кривых над конечными полями. Обеспечивает аналогичную стойкость с меньшим размером ключа, чем RSA.

### Хеш-функции

*   **Назначение:** Преобразование произвольного массива данных в битовую строку фиксированной длины (хеш, дайджест).
*   **Требования к криптографическим хеш-функциям:**
    1.  **Детерминированность:** Один и тот же вход всегда дает одинаковый хеш.
    2.  **Стойкость к коллизиям:** Вычислительно невозможно найти два разных входа с одинаковым хешем.
    3.  **Стойкость к прообразу:** Вычислительно невозможно подобрать вход для заданного хеша.
    4.  **Лавинный эффект:** Незначительное изменение входа drastically меняет хеш.
*   **Применение:** Проверка целостности данных, хранение паролей, цифровые подписи.
*   **Примеры алгоритмов:** **SHA-256**, **SHA-3** (семейство Keccak), **MD5** (считается небезопасным).

### Цифровые подписи

*   **Назначение:** Обеспечение аутентичности, целостности и невозможности отказа от авторства электронного документа.
*   **Принцип работы:**
    1.  Отправитель вычисляет хеш сообщения.
    2.  Отправитель **шифрует** этот хеш своим **закрытым ключом** — это и есть подпись.
    3.  Подпись присоединяется к сообщению.
    4.  Получатель **расшифровывает** подпись **открытым ключом** отправителя, получая хеш.
    5.  Получатель самостоятельно вычисляет хеш полученного сообщения.
    6.  Если два хеша совпали, подпись верна.

### Протокол обмена ключами Диффи-Хеллмана

*   **Назначение:** Безопасное создание общего секретного ключа через незащищенный канал связи для последующего использования в симметричном шифровании.
*   **Принцип:** Основан на сложности вычисления дискретного логарифма в конечных полях.
*   **Результат:** Две стороны независимо вычисляют общий секретный ключ, не передавая его по каналу связи.

### Основные атаки на криптосистемы

*   **Атака грубой силой (brute-force)** — полный перебор всех возможных ключей.
*   **Атака "человек посередине" (MitM)** — перехват и подмена сообщений и ключей между сторонами.
*   **Атака по времени** — анализ времени выполнения операций для извлечения ключа.
*   **Атака на основе подобранного plaintext/ciphertext** — анализ выходных данных при известном входном или наоборот.

**Вывод:** Современные криптографические системы часто используют **гибридный подход**: асимметричное шифрование (RSA, ECC) используется для безопасной передачи сеансового ключа, а симметричное (AES) — для быстрого шифрования больших объемов данных этим ключом. Хеш-функции и цифровые подписи обеспечивают целостность и аутентичность.


## Задания

### Задание 1 (по вариантам)

**1.** Реализовать программу, выполняющую шифрование и расшифровку текста двумя разными методами. Для методов, требующих ключа определенного вида, например для перестановок, ключ должен формироваться на основании одного произвольного ключа, задаваемого пользователем. Пример ключа: фф12К52. Зашифрованный и дешифрованный тексты должны быть идентичными.

<span style='color:red'>НИКОГДА ИСПОЛЬЗУЙТЕ САМОСТОЯТЕЛЬНО РЕАЛИЗОВАННЫЕ АЛГОРИТМЫ ШИФРОВАНИЯ В ПРОДАКШЕНЕ!!!</span>

|Вариант|Симметричный шифр| Асимметричный шифр|
|:---|:---|:---|
|1|[Атбаш](https://ru.wikipedia.org/wiki/Атбаш)|[Криптосистема Бенало](https://ru.wikipedia.org/wiki/Криптосистема_Бенало)|
|2|[Шифр Цезаря](https://ru.wikipedia.org/wiki/Шифр_Цезаря)|[Криптосистема Блюма — Гольдвассер](https://ru.wikipedia.org/wiki/Криптосистема_Блюма_—_Гольдвассер)|
|3|[Великий Шифр Россиньоля](https://ru.wikipedia.org/wiki/Великий_Шифр)|[Криптосистема Дамгорда — Юрика](https://ru.wikipedia.org/wiki/Криптосистема_Дамгорда_—_Юрика)|
|4|[Книжный шифр](https://ru.wikipedia.org/wiki/Книжный_шифр)|[Криптосистема Гольдвассер — Микали](https://ru.wikipedia.org/wiki/Криптосистема_Гольдвассер_—_Микали)|
|5|[Полиалфавитный шифр](https://ru.wikipedia.org/wiki/Полиалфавитный_шифр)|[Криптосистема Накаша — Штерна](https://ru.wikipedia.org/wiki/Криптосистема_Накаша_—_Штерна)|
|6|[Шифр Виженера](https://ru.wikipedia.org/wiki/Шифр_Виженера)|[Криптосистема_Пэйе](https://ru.wikipedia.org/wiki/Криптосистема_Пэйе)|
|7|[Шифр Вернама](https://ru.wikipedia.org/wiki/Шифр_Вернама)|[Криптосистема Рабина](https://ru.wikipedia.org/wiki/Криптосистема_Рабина)|
|8|[Шифр Хилла](https://ru.wikipedia.org/wiki/Шифр_Хилла)|[Криптосистема Крамера – Шоупа](https://ru.wikipedia.org/wiki/Криптосистема_Крамера_–_Шоупа)|
|9|[Великий Шифр Россиньоля](https://ru.wikipedia.org/wiki/Великий_Шифр)|[Криптосистема Дамгорда — Юрика](https://ru.wikipedia.org/wiki/Криптосистема_Дамгорда_—_Юрика)|
|10|[Книжный шифр](https://ru.wikipedia.org/wiki/Книжный_шифр)|[ECDSA](https://ru.wikipedia.org/wiki/ECDSA)|
|11|[Книжный шифр](https://ru.wikipedia.org/wiki/Книжный_шифр)|[ECDSA](https://ru.wikipedia.org/wiki/ECDSA)|
|12|[Шифр Цезаря](https://ru.wikipedia.org/wiki/Шифр_Цезаря)|[Схема Эль-Гамаля](https://ru.wikipedia.org/wiki/Схема_Эль-Гамаля)|
|13|[Шифр Цезаря](https://ru.wikipedia.org/wiki/Шифр_Цезаря)|[Схема Эль-Гамаля](https://ru.wikipedia.org/wiki/Схема_Эль-Гамаля)|
|14|[Великий Шифр Россиньоля](https://ru.wikipedia.org/wiki/Великий_Шифр)|[ECIES](https://ru.wikipedia.org/wiki/ECIES)|
|15|[Великий Шифр Россиньоля](https://ru.wikipedia.org/wiki/Великий_Шифр)|[ECIES](https://ru.wikipedia.org/wiki/ECIES)|
|16|[Атбаш](https://ru.wikipedia.org/wiki/Атбаш)|[XTR](https://ru.wikipedia.org/wiki/XTR_(алгоритм))|
|17|[Атбаш](https://ru.wikipedia.org/wiki/Атбаш)|[Криптосистема Бенало](https://ru.wikipedia.org/wiki/Криптосистема_Бенало)|
|18|[Шифр Цезаря](https://ru.wikipedia.org/wiki/Шифр_Цезаря)|[Криптосистема Блюма — Гольдвассер](https://ru.wikipedia.org/wiki/Криптосистема_Блюма_—_Гольдвассер)|
|19|[Великий Шифр Россиньоля](https://ru.wikipedia.org/wiki/Великий_Шифр)|[Криптосистема Дамгорда — Юрика](https://ru.wikipedia.org/wiki/Криптосистема_Дамгорда_—_Юрика)|
|20|[Книжный шифр](https://ru.wikipedia.org/wiki/Книжный_шифр)|[Криптосистема Гольдвассер — Микали](https://ru.wikipedia.org/wiki/Криптосистема_Гольдвассер_—_Микали)|
|21|[Великий Шифр Россиньоля](https://ru.wikipedia.org/wiki/Великий_Шифр)|[ECIES](https://ru.wikipedia.org/wiki/ECIES)|
|22|[Полиалфавитный шифр](https://ru.wikipedia.org/wiki/Полиалфавитный_шифр)|[Криптосистема Накаша — Штерна](https://ru.wikipedia.org/wiki/Криптосистема_Накаша_—_Штерна)|
|23|[Шифр Виженера](https://ru.wikipedia.org/wiki/Шифр_Виженера)|[Криптосистема Пэйе](https://ru.wikipedia.org/wiki/Криптосистема_Пэйе)|
|24|[Шифр Вернама](https://ru.wikipedia.org/wiki/Шифр_Вернама)|[Криптосистема Рабина](https://ru.wikipedia.org/wiki/Криптосистема_Рабина)|
|25|[Шифр Плейфера](https://ru.wikipedia.org/wiki/Шифр_Плейфера)|[Криптосистема Окамото — Утиямы](https://ru.wikipedia.org/wiki/Криптосистема_Окамото_—_Утиямы)|
|26|[Атбаш](https://ru.wikipedia.org/wiki/Атбаш)|[XTR](https://ru.wikipedia.org/wiki/XTR_(алгоритм))|
|27|[Шифр Вернама](https://ru.wikipedia.org/wiki/Шифр_Вернама)|[Криптосистема Рабина](https://ru.wikipedia.org/wiki/Криптосистема_Рабина)|
|28|[Шифр Цезаря](https://ru.wikipedia.org/wiki/Шифр_Цезаря)|[Криптосистема Блюма — Гольдвассер](https://ru.wikipedia.org/wiki/Криптосистема_Блюма_—_Гольдвассер)|
|29|[Шифр Хилла](https://ru.wikipedia.org/wiki/Шифр_Хилла)|[Криптосистема Крамера – Шоупа](https://ru.wikipedia.org/wiki/Криптосистема_Крамера_–_Шоупа)|


### Методика и порядок выполнения работы

Для успешного выполнения и ащиты лабораторной работ, необходимо выполнить следующие этапы:

1. изучить теоретический материал по теме лабораторной работы (лекции, учебники);
2. написать программу для каждого задания;
3. оформить отчет по лабораторной работе;
4. защитить лабораторную работу.


### Содержание отчета и его форма

Отчет по лабораторной работе должен содержать:

1. Номер и название лабораторной работы; цель и задачи лабораторной работы.

2.  Словесная постановка задачи.
    В этом подразделе проводится полное описание задачи.
    Описывается суть задачи, анализ входящих в нее переменных, возможные ограничения, анализ условий
    при которых задача имеет решение (не имеет решения), анализ ожидаемых результатов;

3.  Листинг программного кода с комментариями, показывающие порядок выполнения лабораторной работы, и результаты, полученные в ходе её выполнения.

4. Выводы по лабораторной работе.


### Контрольные вопросы

1.  Дайте определение следующим терминам: шифрование, дешифрование, исходный текст, шифротекст, ключ.
2.  В чём состоит основное отличие симметричного шифрования от асимметричного?
3.  Опишите принцип работы симметричного шифрования. В чём его главный недостаток?
4.  Назовите и охарактеризуйте 2-3 современных алгоритма симметричного шифрования (например, AES, DES, 3DES).
5.  Почему алгоритм DES считается устаревшим и небезопасным?
6.  Что такое режим работы блочного шифра? Приведите примеры режимов (ECB, CBC, CFB, OFB).
7.  Объясните принцип асимметричного шифрования. Что такое открытый и закрытый ключ?
8.  В чём заключаются преимущества и недостатки асимметричного шифрования по сравнению с симметричным?
9.  Опишите, как происходит шифрование и дешифрование в алгоритме RSA.
10. На какой вычислительно сложной задаче основана стойкость RSA?
11. Что такое электронная цифровая подпись (ЭЦП)? Опишите процесс её создания и проверки с использованием асимметричной криптографии.
12. Для чего на практике часто используется гибридная криптосистема? Как в ней сочетаются симметричные и асимметричные алгоритмы?
13. Дайте определение криптографической хеш-функции. Перечислите её ключевые свойства.
14. Что такое "лавинный эффект" и почему он важен для хеш-функций?
15. Для чего используются хеш-функции в криптографии? Приведите 3 примера их применения.
16. Почему хеш-функции используются для безопасного хранения паролей? Что такое "соль" (salt) и для чего она нужна?
17. Назовите современные алгоритмы хеш-функций (например, SHA-256, SHA-3). Почему MD5 и SHA-1 считаются небезопасными?
18. Опишите суть протокола Диффи-Хеллмана. Какую проблему он решает?
19. Почему протокол Диффи-Хеллмана уязвим к атаке "человек посередине" (MitM)? Как можно защититься от этой атаки?
20. Что такое сертификат открытого ключа и для чего он нужен? Какую роль в этом играют центры сертификации (CA)?
21. Что такое криптоанализ? Какие основные виды атак на криптосистемы вам известны?
22. Что такое атака грубой силой (brute-force)? Как можно увеличить стойкость шифра к такой атаке?
23. Почему длина ключа является важным фактором стойкости шифра? Сравните стойкость ключей AES-128 и AES-256.
24. Что такое атака по времени и как от неё можно защититься?
25. Зашифруйте короткое сообщение с помощью шифра Цезаря. Объясните, почему он небезопасен.
26. Предложите способ безопасного обмена сеансовым ключом между двумя сторонами.
27. Объясните, почему нельзя использовать один и тот же ключ для симметричного шифрования в течение длительного времени.
28. Как с помощью хеш-функции можно проверить целостность большого файла, скачанного из интернета?
29. *Задача на понимание RSA:* Если открытый ключ — это (e, n), а закрытый — (d, n), что должны вычислять алгоритмы шифрования и дешифрования?
30. В чём основная разница между функциями SHA-256 и SHA-3?


### Список литературы

1. Кнут, Д. Э. Искусство программирования: пер. с англ. / Д. Э. Кнут . - 3-е изд. - Москва : Вильямс, 2007. - Т. 1 : Основные алгоритмы, 2007. - 720 с. : ил.. - Прил.: с. 683-691. - Предм.-имен. указ.: с. 692-712. - ISBN 5-8459-0080-8.
2. Кнут, Д. Э. Искусство программирования / Д. Э. Кнут ; под общ. ред. Ю. В. Козаченко. - 2-е изд. - М. : Вильямс, 2009. - (Классический труд : Исправленное и дополненное издание). Т. 3 : Сортировка и поиск. - , 2009. - 823 с. : ил.. - Прил.: с. 794-803. - . - Предм.-имен. указ.: с. 804-822 - ISBN 978-5-8459-0082-1.
3. Кормен, Т. Алгоритмы: Построение и анализ / Т. Кормен, Ч. Лейхерсон, Р. Риверст. – М.: МЦМНО, 2002.
4. Давыдов, В. Г.  Программирование и основы алгоритмизации: учеб.
пособие для вузов / В. Г. Давыдов. - М. : Высш. шк., 2003. - 447 с. : ил - ISBN 5-06-
004432-7.
5. Ахо, А. Построение и анализ вычислительных алгоритмов / А. Ахо, Дж. Хопкрофт, Дж. Ульмен. – М.: Мир, 1989. – 369с.
6. Никлаус Вирт Алгоритмы и структуры данных. – Санкт-Петербург: «Невский диалект», 2001.
